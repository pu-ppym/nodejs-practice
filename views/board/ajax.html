{% include "include/header.html" %}

<main id="main" class="main">

    <div class="pagetitle">
        <h1>공지사항</h1>
    </div><!-- End Page Title -->

    <section class="section">
        <div class="row">
            <div class="col-lg-12">

                <div class="card">
                    <div class="card-body">
                        <table class="table">
                            <thead>
                                <tr class="text-center">
                                    <th scope="col" class="col-1">번호</th>
                                    <th scope="col">제목</th>
                                    <th scope="col" class="col-2">작성자</th>
                                    <th scope="col" class="col-1">조회수</th>
                                    <th scope="col" class="col-1">등록일</th>
                                </tr>
                            </thead>
                            <tbody id="board_tbody">

                            </tbody>
                        </table>
                    </div>

                    <div class="card-footer text-center">
                        <button class="btn btn-sm btn-outline-secondary" type="button"
                            onclick="getList()">More.</button>
                    </div>
                </div>

            </div>
        </div>
    </section>
    <script>
        let page = 0;

        function getList() {
            page++;
            $.ajax({
                url: "getAjaxList",
                type: "get",
                cache: false,
                dataType: "json",
                data: "page=" + page + "&search_key=" + "",
                async: true,
                success: function (res) {
                    // 정상적으로 처리 완료되면 여기로
                    // json이 res에 담긴다
                    let html = '';

                    console.log(res);
                    if (res.length != undefined) {
                        for (i = 0; i < res.length; i++) {
                            console.log(res[i].pkid);
                            console.log(res[i].title);
                            
                            // html에 string으로 계속 담김
                            html += '<tr class="text-center">' +
                            
                                '<th scope="row">' + res[i].pkid +'</th>' + 
                                '<td><a href="#">' + res[i].title +'</a></td>' +
                                '<td>' + res[i].name +'</td>' +
                                '<td>' + res[i].viewcount +'</td>' +
                                '<td>' + res[i].regdate +'</td>' +
                            '</tr>';
                        }
                    }

                    $('#board_tbody').append(html);

                },
                error: function (request, status, error) {
                    alert("서비스가 원활하지 못합니다. 잠시후 다시 시도해 주시거나 관리자에게 문의해 주세요. ");
                    console.log(error);
                }
            });

        }

        $(document).ready(function () {
            // 여기서 data 가져오면 됨.
            //alert("로딩이 끝나면 이거 출력해"); 
            getList();
        });

    </script>
</main>

{% include "include/footer.html" %}